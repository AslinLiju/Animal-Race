<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Race Game</title>
    <style>
        #track {
            width: 100%;
            height: 400px;
            position: relative;
            margin: 20px auto;
            border: 2px solid #333;
            display: flex;
            justify-content: flex-start;
            overflow: hidden;
            background-color: #fff;
        }
        .animal {
            width: 50px;
            height: 50px;
            position: absolute;
            background-size: cover;
        }
        .food {
            width: 30px;
            height: 30px;
            position: absolute;
            background-size: cover;
        }
        .terrain {
            height: 100%;
            position: absolute;
            background-size: cover;
        }
        .black-line {
            position: absolute;
            width: 2px;
            height: 100%;
            background-color: black;
        }

        /* Different terrains */
        .water { background-color: rgb(129, 198, 241); }
        .forest { background-color: #6be96b; }
        .grassland { background-color: rgb(249, 136, 7); }

        /* Winner stage styling */
        #winnerStage {
            display: none; /* Hidden until there is a winner */
            margin-top: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }

        /* Podium styling */
        #podiumContainer {
            display: none; /* Hidden until the race ends */
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 200px;
        }
        .podium {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            font-weight: bold;
            color: white;
        }
        .gold { background-color: gold; height: 150px; }
        .silver { background-color: silver; height: 120px; }
        .bronze { background-color: #cd7f32; height: 100px; }
        .animal-image {
            width: 60px;
            height: 60px;
            position: absolute;
            bottom: 50%;
            transform: translateY(50%);
        }

        /* Fireworks/crackers animation */
        .firework {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: red;
            animation: explode 1s ease-out infinite;
        }

        /* Keyframes for fireworks effect */
        @keyframes explode {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(3); opacity: 0; }
        }
    </style>
</head>
<body>

<h2>Animal Race Game</h2>
<div id="track"></div>
<button onclick="startGame()">Start Game</button>
<div id="winnerStage"></div> <!-- Stage to display winner and celebration -->

<!-- Podium Section -->
<div id="podiumContainer">
    <div class="podium silver"><img id="secondPlace" class="animal-image" src=""></div>
    <div class="podium gold"><img id="firstPlace" class="animal-image" src=""></div>
    <div class="podium bronze"><img id="thirdPlace" class="animal-image" src=""></div>
</div>

<script>
    const track = document.getElementById("track");
    const trackWidth = track.clientWidth;

    const animalImages = {
        dog: 'dog running.gif',
        turtle: 'turtle running.gif',
        monkey: 'monkey running.gif'
    };
    const animalFiles = {
        dog: 'dog.png',
        turtle: 'turtle.png',
        monkey: 'monkey.png'
    };

    const foodImages = {
        banana: 'banana.jpg',
        grass: 'lettuce.jpg',
        bone: 'bone.jpeg'
    };

    let animalPositions = [];
    let foodEaten = { dog: false, turtle: false, monkey: false };

    function generateTerrains() {
        let currentLeft = 0;
        const terrains = ['water', 'forest', 'grassland'];
        track.innerHTML = '';

        const numTerrains = 5 + Math.floor(Math.random() * 6);
        for (let i = 0; i < numTerrains; i++) {
            const terrainDiv = document.createElement("div");
            const terrainType = terrains[Math.floor(Math.random() * terrains.length)];
            terrainDiv.classList.add("terrain", terrainType);
            const terrainWidth = 100 + Math.floor(Math.random() * 200);
            terrainDiv.style.left = `${currentLeft}px`;
            terrainDiv.style.width = `${terrainWidth}px`;
            track.appendChild(terrainDiv);

            const blackLine = document.createElement("div");
            blackLine.classList.add("black-line");
            blackLine.style.left = `${currentLeft + terrainWidth}px`;
            track.appendChild(blackLine);

            currentLeft += terrainWidth + 2;
        }
    }

    function placeAnimals() {
        Object.keys(animalImages).forEach((animalName, index) => {
            const animalDiv = document.createElement("div");
            animalDiv.id = animalName;
            animalDiv.classList.add("animal");
            animalDiv.style.backgroundImage = `url('${animalImages[animalName]}')`;
            animalDiv.style.left = "0px";
            animalDiv.style.top = `${(index + 1) * 80}px`;
            track.appendChild(animalDiv);
        });
    }

    function distributeFood() {
        const foodItems = ['banana', 'grass', 'bone'];
        const totalFoodItems = 5; // Adjust this to change the number of food items on each track

        for (let i = 0; i < totalFoodItems; i++) {
            const randomFood = foodItems[Math.floor(Math.random() * foodItems.length)];
            const foodDiv = document.createElement("div");
            foodDiv.classList.add("food", randomFood);
            foodDiv.style.backgroundImage = `url('${foodImages[randomFood]}')`;
            foodDiv.style.left = `${Math.random() * (trackWidth - 50)}px`;

            // Align food items with the animal rows for a straight positioning
            const row = Math.floor(Math.random() * 3) + 1;
            foodDiv.style.top = `${row * 80}px`;

            track.appendChild(foodDiv);
        }
    }

    function startGame() {
        generateTerrains();
        placeAnimals();
        distributeFood();
        animalPositions = []; // Reset animal positions for new race
        foodEaten = { dog: false, turtle: false, monkey: false }; // Reset food eaten status
        document.getElementById("winnerStage").style.display = "none"; // Hide winner stage
        document.getElementById("podiumContainer").style.display = "none"; // Hide podium
        moveAnimals();
    }

    function moveAnimals() {
    const animals = document.querySelectorAll(".animal");
    const foodItems = document.querySelectorAll(".food");

    const interval = setInterval(() => {
        animals.forEach(animal => {
            let currentLeft = parseFloat(animal.style.left);
            let speed = 2;  // Default speed

            // Check if the animal has eaten its food and increase speed for 3 seconds
            if (foodEaten[animal.id] && foodEaten[animal.id].timeLeft > 0) {
                speed =7;
                foodEaten[animal.id].timeLeft -= 100; // Reduce the time left by 100ms (for each iteration of the interval)
            } else if (foodEaten[animal.id] && foodEaten[animal.id].timeLeft <= 0) {
                foodEaten[animal.id] = false; // Reset foodEaten status after 3 seconds
            }

            const terrain = document.elementFromPoint(currentLeft + 25, parseFloat(animal.style.top) + 25);
            const terrainClass = terrain ? terrain.classList[1] : "";

            // Set speed based on terrain
            if (terrainClass === "water") {
                if (animal.id === 'turtle') speed = 7;
                else if (animal.id === 'dog') speed = 3;
                else speed = 2;
            } else if (terrainClass === "forest") {
                if (animal.id === 'monkey') speed = 7;
                else if (animal.id === 'dog') speed = 3;
                else speed = 2;
            } else if (terrainClass === "grassland") {
                if (animal.id === 'dog') speed = 7;
                else if (animal.id === 'monkey') speed = 3;
                else speed = 2;
            }

            // Move the animal forward
            currentLeft += speed;

            // Ensure animal doesn't move past the track
            if (currentLeft > trackWidth - 50) {
                currentLeft = trackWidth - 50;
                if (!animalPositions.includes(animal.id)) {
                    animalPositions.push(animal.id);
                }
            }
            animal.style.left = `${currentLeft}px`;

            // Check for food consumption
            foodItems.forEach(food => {
                if (!foodEaten[animal.id] && Math.abs(currentLeft - parseFloat(food.style.left)) < 30 && Math.abs(parseFloat(animal.style.top) - parseFloat(food.style.top)) < 30) {
                    if ((animal.id === 'monkey' && food.classList.contains('banana')) ||
                        (animal.id === 'turtle' && food.classList.contains('grass')) ||
                        (animal.id === 'dog' && food.classList.contains('bone'))) {
                        foodEaten[animal.id] = { eaten: true, timeLeft: 3000 }; // Set the boost time for 3 seconds (3000ms)
                        food.remove();
                    }
                }
            });

        });

        if (animalPositions.length === 3) {
            clearInterval(interval); // Stop the race when all animals finish
            displayWinner(); // Show podium for winners
        }
    }, 100);
}

    function displayWinner() {
        document.getElementById("winnerStage").innerText = `Winner: ${animalPositions[0]}`;
        document.getElementById("winnerStage").style.display = "block";

        document.getElementById("podiumContainer").style.display = "flex";
        document.getElementById("firstPlace").src = animalFiles[animalPositions[0]];
        document.getElementById("secondPlace").src = animalFiles[animalPositions[1]];
        document.getElementById("thirdPlace").src = animalFiles[animalPositions[2]];

        // Display celebratory fireworks
        createFireworks();
    }

    function createFireworks() {
        for (let i = 0; i < 10; i++) {
            const firework = document.createElement("div");
            firework.classList.add("firework");
            firework.style.left = `${Math.random() * 100}%`;
            firework.style.top = `${Math.random() * 50}%`;
            document.body.appendChild(firework);

            setTimeout(() => firework.remove(), 10000);
        }
    }
</script>
</body>
</html>
